From f5e9621355abba25bf18afb50c75045322617e78 Mon Sep 17 00:00:00 2001
From: Marian Koncek <mkoncek@redhat.com>
Date: Mon, 11 Mar 2024 12:16:28 +0100
Subject: [PATCH 3/3] Remove Pack200 compressor

Forwarded: not-needed
---
 .../compress/compressors/CompressorStreamFactory.java    | 9 ++-------
 1 file changed, 2 insertions(+), 7 deletions(-)

diff --git a/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java b/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
index a7432c4..3d405e7 100644
--- a/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
+++ b/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
@@ -43,8 +43,6 @@ import org.apache.commons.compress.compressors.lz4.FramedLZ4CompressorOutputStre
 import org.apache.commons.compress.compressors.lzma.LZMACompressorInputStream;
 import org.apache.commons.compress.compressors.lzma.LZMACompressorOutputStream;
 import org.apache.commons.compress.compressors.lzma.LZMAUtils;
-import org.apache.commons.compress.compressors.pack200.Pack200CompressorInputStream;
-import org.apache.commons.compress.compressors.pack200.Pack200CompressorOutputStream;
 import org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorInputStream;
 import org.apache.commons.compress.compressors.snappy.FramedSnappyCompressorOutputStream;
 import org.apache.commons.compress.compressors.snappy.SnappyCompressorInputStream;
@@ -242,9 +240,6 @@ public class CompressorStreamFactory implements CompressorStreamProvider {
         if (compressorNames.contains(GZIP) && GzipCompressorInputStream.matches(signature, signatureLength)) {
             return GZIP;
         }
-        if (compressorNames.contains(PACK200) && Pack200CompressorInputStream.matches(signature, signatureLength)) {
-            return PACK200;
-        }
         if (compressorNames.contains(SNAPPY_FRAMED) && FramedSnappyCompressorInputStream.matches(signature, signatureLength)) {
             return SNAPPY_FRAMED;
         }
@@ -619,7 +614,7 @@ public class CompressorStreamFactory implements CompressorStreamProvider {
                 return LZMACompressorInputStream.builder().setInputStream(in).setMemoryLimitKiB(memoryLimitInKb).get();
             }
             if (PACK200.equalsIgnoreCase(name)) {
-                return new Pack200CompressorInputStream(in);
+                throw new CompressorException("Pack200 compression is not available in this build.");
             }
             if (SNAPPY_RAW.equalsIgnoreCase(name)) {
                 return new SnappyCompressorInputStream(in);
@@ -680,7 +675,7 @@ public class CompressorStreamFactory implements CompressorStreamProvider {
                 return new XZCompressorOutputStream(out);
             }
             if (PACK200.equalsIgnoreCase(name)) {
-                return new Pack200CompressorOutputStream(out);
+                throw new CompressorException("Pack200 compression is not available in this build.");
             }
             if (LZMA.equalsIgnoreCase(name)) {
                 return new LZMACompressorOutputStream(out);
-- 
2.51.0

